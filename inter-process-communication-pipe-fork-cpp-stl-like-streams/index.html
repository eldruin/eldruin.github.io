<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><title>Inter-Process Communication: pipe(), fork() and C++ STL-like streams | Eldruin&#39;s blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="c++,ipc,stl"><meta name="description" content="Example of inter-process comunication in C++ using STL-like streams."><meta name="keywords" content="c++,ipc,stl"><meta property="og:type" content="article"><meta property="og:title" content="Inter-Process Communication: pipe(), fork() and C++ STL-like streams"><meta property="og:url" content="https://blog.eldruin.com/inter-process-communication-pipe-fork-cpp-stl-like-streams/index.html"><meta property="og:site_name" content="Eldruin&#39;s blog"><meta property="og:description" content="Example of inter-process comunication in C++ using STL-like streams."><meta property="og:locale" content="en"><meta property="og:image" content="https://blog.eldruin.com/images/pipe.png"><meta property="og:updated_time" content="2018-09-02T10:24:54.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Inter-Process Communication: pipe(), fork() and C++ STL-like streams"><meta name="twitter:description" content="Example of inter-process comunication in C++ using STL-like streams."><meta name="twitter:image" content="https://blog.eldruin.com/images/pipe.png"><link rel="alternate" href="/atom.xml" title="Eldruin&#39;s blog" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/libs/titillium-web/styles.css"><link rel="stylesheet" href="/libs/source-code-pro/styles.css"><link rel="stylesheet" href="/css/style.css"><script src="/libs/jquery/3.3.1/jquery.min.js"></script><link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css"><link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css"><script type="text/javascript">!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="//www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script"),ga("create","UA-4003933-4","auto"),ga("send","pageview")</script></head></html><body><div id="wrap"><header id="header"><div id="header-outer" class="outer"><div class="container"><div class="container-inner"><div id="header-title"><h1 class="logo-wrap"><a href="/" class="logo"></a></h1><h2 class="subtitle-wrap"><p class="subtitle">Software engineer</p></h2></div><div id="header-inner" class="nav-container"><a id="main-nav-toggle" class="nav-icon fa fa-bars"></a><div class="nav-container-inner"><ul id="main-nav"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/">Home</a></li><ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/embedded/">embedded</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/embedded/rust/">rust</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/programming/">programming</a></li></ul><li class="main-nav-list-item"><a class="main-nav-list-link" href="/about/index.html">About</a></li></ul><nav id="sub-nav"><div id="search-form-wrap"><form class="search-form"><input type="text" class="ins-search-input search-form-input" placeholder="Search"> <button type="submit" class="search-form-submit"></button></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="Type something..."> <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script></div></nav></div></div></div></div></div></header><div class="container"><div class="main-body container-inner"><div class="main-body-inner"><section id="main"><div class="main-body-header"><h1 class="header"><a class="page-title-link" href="/categories/programming/">programming</a></h1></div><div class="main-body-content"><article id="post-/inter-process-communication-pipe-fork-cpp-stl-like-streams" class="article article-single article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">Inter-Process Communication: pipe(), fork() and C++ STL-like streams</h1></header><div class="article-meta"><div class="article-date"><a href="/inter-process-communication-pipe-fork-cpp-stl-like-streams/" class="article-date"><time datetime="2011-04-22T07:04:48.000Z" itemprop="datePublished">2011-04-22</time></a></div><div class="article-tag"><i class="fa fa-tag"></i> <a class="tag-link" href="/tags/c/">c++</a>, <a class="tag-link" href="/tags/ipc/">ipc</a>, <a class="tag-link" href="/tags/stl/">stl</a></div></div><div class="article-entry" itemprop="articleBody"><p>I’ve run into some troubles lately trying to communicate processes through C++ STL-like streams with <code>fork()</code> and <code>pipe()</code> so I’ve created an example of how can this be done in a POSIX environment using the GCC’s libstdc++ (GCC &gt;= 3.4.0).</p><p>The scenario is: A parent process wants to handle another program’s input and output streams, a process-level wrapper.</p><p>So the example is: A parent process forks into another child process. The parent sends the child a message, the child receives it and outputs it to the parent to show the communication works just fine.</p><p>The forked process calls the program we want to control. Which in this case is the easiest C++ program ever: Just reads a line from the standard input and outputs a message containing the line just read through the standard output. In addition, another message is sent through the standard error stream.</p><h2 id="Controlled-program"><a href="#Controlled-program" class="headerlink" title="Controlled program"></a>Controlled program</h2><p>Let’s see the code for the controlled program:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">string</span> message;</span><br><span class="line">  getline(<span class="built_in">cin</span>, message);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">"Program: I've received: "</span></span><br><span class="line">       &lt;&lt; <span class="string">"'"</span> &lt;&lt; message  &lt;&lt; <span class="string">"'"</span></span><br><span class="line">       &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">cerr</span> &lt;&lt; <span class="string">"Program: This is the error stream!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>As you can see we use the standard input/output streams <code>cin</code>, <code>cout</code> and <code>cerr</code>.</p><h2 id="Main-Program"><a href="#Main-Program" class="headerlink" title="Main Program"></a>Main Program</h2><p>Now let’s see chunks of the main program:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CHILD_STDIN_READ pipefds_input[0]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CHILD_STDIN_WRITE pipefds_input[1]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> pipefds_input[<span class="number">2</span>], pipefds_output[<span class="number">2</span>], pipefds_error[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create the pipes</span></span><br><span class="line"><span class="comment">// We do this before the fork so both processes will know about</span></span><br><span class="line"><span class="comment">// the same pipe and they can communicate.</span></span><br><span class="line"></span><br><span class="line">pipe_status = pipe(pipefds_input);</span><br><span class="line"><span class="keyword">if</span> (pipe_status == <span class="number">-1</span>)</span><br><span class="line">&#123;</span><br><span class="line">  perror(<span class="string">"Error creating the pipe"</span>);</span><br><span class="line">  <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>With the definitions you won’t mistake the pipe ends.</p><p>We repeat the same process for the pipes for standard output and error.</p><h2 id="fork-skeleton"><a href="#fork-skeleton" class="headerlink" title="fork() skeleton"></a>fork() skeleton</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pid_t</span> pid;</span><br><span class="line">pid = fork();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (pid == <span class="keyword">pid_t</span>(<span class="number">0</span>))</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// Child process</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (pid &gt; <span class="keyword">pid_t</span>(<span class="number">0</span>))</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// Parent</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// Error: fork failed</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Shared code</span></span><br></pre></td></tr></table></figure><p>This is the skeleton for a <code>fork()</code>. When you call <code>fork()</code> a new process is created in memory and the pid return value is set to two different values in each process.</p><h2 id="Standard-streams-tying"><a href="#Standard-streams-tying" class="headerlink" title="Standard streams tying"></a>Standard streams tying</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Child Process</span></span><br><span class="line"><span class="comment">// Tie the standard input, output and error streams to the</span></span><br><span class="line"><span class="comment">// appropiate pipe ends</span></span><br><span class="line"><span class="comment">// The file descriptor 0 is the standard input</span></span><br><span class="line"><span class="comment">// We tie it to the read end of the pipe as we will use</span></span><br><span class="line"><span class="comment">// this end of the pipe to read from it</span></span><br><span class="line"><span class="comment">// Same for the others</span></span><br><span class="line">dup2 (CHILD_STDIN_READ,<span class="number">0</span>);</span><br><span class="line">dup2 (CHILD_STDOUT_WRITE,<span class="number">1</span>); <span class="comment">// standard output</span></span><br><span class="line">dup2 (CHILD_STDERR_WRITE,<span class="number">2</span>); <span class="comment">// standard error</span></span><br><span class="line"><span class="comment">// Close in the child the unused ends of the pipes</span></span><br><span class="line"><span class="built_in">close</span>(CHILD_STDIN_WRITE);</span><br><span class="line"><span class="built_in">close</span>(CHILD_STDOUT_READ);</span><br><span class="line"><span class="built_in">close</span>(CHILD_STDERR_READ);</span><br></pre></td></tr></table></figure><p>In each process we only use one end of the pipes, this is, in the child, we only read from stdin and only write to stdout and stderr. So we close the other ends.</p><p>We do the same in the parent process, but don’t need to tie anything this time.</p><h2 id="exec"><a href="#exec" class="headerlink" title="exec()"></a><code>exec()</code></h2><p>In the child we execute the program to be controlled through <code>execl()</code></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Child</span></span><br><span class="line"><span class="comment">// Execute the program</span></span><br><span class="line">execl(<span class="string">"./program"</span>, <span class="string">"program"</span>, (<span class="keyword">char</span>*)<span class="literal">NULL</span>);</span><br></pre></td></tr></table></figure><p>When you call <code>exec()</code>, the called program replaces the executing program, so the streams of the called program are still tied to our pipes.</p><h2 id="Sending-messages"><a href="#Sending-messages" class="headerlink" title="Sending messages"></a>Sending messages</h2><p>Everything is set up now! Let’s send messages!</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Parent</span></span><br><span class="line"><span class="built_in">string</span> message;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"Parent: I'll send the child a message."</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">ofdstream <span class="title">in_stream</span><span class="params">(CHILD_STDIN_WRITE)</span></span>;</span><br><span class="line">in_stream &lt;&lt; <span class="string">"Hello Child!\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">ifdstream <span class="title">out_stream</span><span class="params">(CHILD_STDOUT_READ)</span></span>;</span><br><span class="line">getline(out_stream, message);</span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"Parent: Child just said through stdout: "</span> &lt;&lt; <span class="built_in">endl</span></span><br><span class="line">     &lt;&lt; <span class="string">"\t\""</span> &lt;&lt; message  &lt;&lt; <span class="string">"\""</span> &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><p>We send the message “Hello Child!” through the write end of the child’s stdin pipe.</p><p>The child process get it and outputs another message that we read from the read end of the child’s stdout pipe.</p><h2 id="Pipes-I-O-with-file-descriptors-using-C-STL-streams"><a href="#Pipes-I-O-with-file-descriptors-using-C-STL-streams" class="headerlink" title="Pipes I/O  with file descriptors using C++ STL streams"></a>Pipes I/O with file descriptors using C++ STL streams</h2><p>You can see here two simple functions to read and write strings through pipes using file descriptors and C++ STL-like input/output streams.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">read_from_pipe</span> <span class="params">(<span class="keyword">int</span> file_descriptor)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// We create a C++ stream from a file descriptor</span></span><br><span class="line">  <span class="comment">// stdio_filebuf is not synced with stdio.</span></span><br><span class="line">  <span class="comment">// From GCC 3.4.0 on exists in addition stdio_sync_filebuf</span></span><br><span class="line">  <span class="comment">// You can also create the filebuf from a FILE* with</span></span><br><span class="line">  <span class="comment">// FILE* f = fdopen(file_descriptor, mode);</span></span><br><span class="line">  __gnu_cxx::stdio_filebuf&lt;<span class="keyword">char</span>&gt; filebuf(file_descriptor,</span><br><span class="line">                                         <span class="built_in">std</span>::ios_base::in);</span><br><span class="line">  <span class="function">istream <span class="title">stream</span><span class="params">(&amp;filebuf)</span></span>;</span><br><span class="line">  <span class="comment">// You can also do:</span></span><br><span class="line">  <span class="comment">// ostringstream stream;</span></span><br><span class="line">  <span class="comment">// stream &lt;&lt; &amp;filebuf;</span></span><br><span class="line">  <span class="comment">// return stream.str();</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">string</span> <span class="built_in">line</span>;</span><br><span class="line">  <span class="keyword">if</span> (stream.good())</span><br><span class="line">  &#123;</span><br><span class="line">    getline(stream, <span class="built_in">line</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">line</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write_to_pipe</span> <span class="params">(<span class="keyword">int</span> file_descriptor, <span class="keyword">const</span> <span class="built_in">string</span>&amp; <span class="built_in">line</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __gnu_cxx::stdio_filebuf&lt;<span class="keyword">char</span>&gt; filebuf(file_descriptor,</span><br><span class="line">                                         <span class="built_in">std</span>::ios_base::out);</span><br><span class="line">  <span class="function">ostream <span class="title">stream</span><span class="params">(&amp;filebuf)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (stream.good())</span><br><span class="line">  &#123;</span><br><span class="line">    stream &lt;&lt; <span class="built_in">line</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>I use the <code>__gnu_cxx::stdio_filebuf</code> class. This class is part of the GNU extensions of the libstdc++ library.</p><p>From the library documentation:</p><blockquote><p>[This class] Provides a layer of compatibility for C/POSIX.This GNU extension provides extensions for working with standard C FILE*’s and POSIX file descriptors. It must be instantiated by the user with the type of character used in the file stream, e.g., <code>stdio_filebuf&lt;char&gt;</code>.</p></blockquote><p>With this object we can create a STL istream or ostream giving its contructor the address of our object.</p><p>I’ve created two C++ classes so we can interact with the child’s streams like they were C++ STL streams instead of using these functions. You can see here the interface.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ifdstream</span> :</span> <span class="keyword">public</span> _fdstream</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  ifdstream();</span><br><span class="line">  ifdstream(<span class="keyword">int</span> file_descriptor);</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">open</span><span class="params">(<span class="keyword">int</span> file_descriptor)</span></span>;</span><br><span class="line">  ifdstream&amp; <span class="keyword">operator</span>&gt;&gt; (<span class="built_in">string</span>&amp; str);</span><br><span class="line">  <span class="keyword">size_t</span> getline (<span class="keyword">char</span>* s, streamsize n);</span><br><span class="line">  <span class="keyword">size_t</span> getline (<span class="keyword">char</span>* s, streamsize n, <span class="keyword">char</span> delim);</span><br><span class="line">  ~ifdstream();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ofdstream</span> :</span> <span class="keyword">public</span> _fdstream</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  ofdstream();</span><br><span class="line">  ofdstream(<span class="keyword">int</span> file_descriptor);</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">open</span><span class="params">(<span class="keyword">int</span> file_descriptor)</span></span>;</span><br><span class="line">  ofdstream&amp; <span class="keyword">operator</span>&lt;&lt; (<span class="keyword">const</span> <span class="built_in">string</span>&amp; str);</span><br><span class="line">  ~ofdstream();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>With these classes you can create STL-like C++ streams from your file descriptors so you can read and write from/to the pipes with the usual <code>&gt;&gt;</code> and <code>&lt;&lt;</code> operators. I haven’t implemented more functions as this is only a demonstration.</p><p><strong>That’s all folks!</strong> You can now create families of talking processes!</p><h2 id="Source-code"><a href="#Source-code" class="headerlink" title="Source code"></a>Source code</h2><p>You can find the full source code <a href="https://github.com/eldruin/IPC-FDStream" target="_blank" rel="noopener">on GitHub</a>.</p><p>The code is in the public domain, you can do whatever you want with it.</p><p>Improvements and comments are most appreciated.</p><p>Of course this code is for educational purposes only. If you want to do something serious about file descriptors and C++ streams have a look at <code>boost::iostreams::file_descriptor</code> and <code>boost::iostreams::stream</code>.</p><h2 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h2><ul><li><a href="https://github.com/eldruin/IPC-FDStream" target="_blank" rel="noopener">Souce code repository</a></li><li><a href="http://www.yolinux.com/TUTORIALS/ForkExecProcesses.html" target="_blank" rel="noopener">YoLinux Tutorial: Fork, Exec and Process control</a></li><li><a href="http://www.advancedlinuxprogramming.com/alp-folder" target="_blank" rel="noopener">Advanced Linux Programming Book</a>: IPC chapter</li><li><a href="http://tldp.org/LDP/lpg-0.4.pdf" target="_blank" rel="noopener">Linux Programmer’s Guide</a></li><li><a href="http://www.gnu.org/software/libc/manual/" target="_blank" rel="noopener">The GNU C Library manual</a></li><li><a href="http://gcc.gnu.org/onlinedocs/libstdc++/" target="_blank" rel="noopener">The GNU C++ Library manual</a></li><li><a href="http://www.ginac.de/~kreckel/fileno/" target="_blank" rel="noopener">fileno(3) on C++ Streams: A Hacker’s Lament</a>, Richard B. Kreckel</li></ul></div><footer class="article-footer"><a data-url="https://blog.eldruin.com/inter-process-communication-pipe-fork-cpp-stl-like-streams/" data-id="ck401rxij000cs27hhmcsdzgc" class="article-share-link"><i class="fa fa-share"></i>Share</a><script>!function(n){n("body").on("click",function(){n(".article-share-box.on").removeClass("on")}).on("click",".article-share-link",function(t){t.stopPropagation();var e,a=n(this),o=a.attr("data-url"),r=encodeURIComponent(o),i="article-share-box-"+a.attr("data-id"),s=a.offset();if(n("#"+i).length){if((e=n("#"+i)).hasClass("on"))return void e.removeClass("on")}else{var l=['<div id="'+i+'" class="article-share-box">','<input class="article-share-input" value="'+o+'">','<div class="article-share-links">','<a href="https://twitter.com/intent/tweet?url='+r+'" class="article-share-twitter" target="_blank" title="Twitter"></a>','<a href="https://www.facebook.com/sharer.php?u='+r+'" class="article-share-facebook" target="_blank" title="Facebook"></a>','<a href="http://pinterest.com/pin/create/button/?url='+r+'" class="article-share-pinterest" target="_blank" title="Pinterest"></a>','<a href="https://plus.google.com/share?url='+r+'" class="article-share-google" target="_blank" title="Google+"></a>',"</div>","</div>"].join("");e=n(l),n("body").append(e)}n(".article-share-box.on").hide(),e.css({top:s.top+25,left:s.left}).addClass("on")}).on("click",".article-share-box",function(t){t.stopPropagation()}).on("click",".article-share-box-input",function(){n(this).select()}).on("click",".article-share-box-link",function(t){t.preventDefault(),t.stopPropagation(),window.open(this.href,"article-share-box-window-"+Date.now(),"width=500,height=450")})}(jQuery)</script></footer></div></article><section id="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></section></div></section><aside id="sidebar"><a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a><div class="sidebar-top"><p>follow:</p><ul class="social-links"><li><a class="social-tooltip" title="github" href="https://github.com/eldruin" target="_blank" rel="noopener"><i class="icon fa fa-github"></i></a></li><li><a class="social-tooltip" title="rss" href="/atom.xml" target="_blank" rel="noopener"><i class="icon fa fa-rss"></i></a></li></ul></div><nav id="article-nav"><a href="/sound2header/" id="article-nav-newer" class="article-nav-link-wrap"><strong class="article-nav-caption">newer</strong><p class="article-nav-title">Sound2Header</p><i class="icon fa fa-chevron-right" id="icon-chevron-right"></i> </a><a href="/dsmemorizer/" id="article-nav-older" class="article-nav-link-wrap"><strong class="article-nav-caption">older</strong><p class="article-nav-title">DSMemorizer</p><i class="icon fa fa-chevron-left" id="icon-chevron-left"></i></a></nav><div class="widgets-container"><div class="widget-wrap"><h3 class="widget-title">recents</h3><div class="widget"><ul id="recent-post"><li><div class="item-thumbnail"><a href="/pca9685-pwm-led-servo-controller-driver-in-rust/" class="thumbnail"><span style="background-image:url(/images/pca9685-module.jpg)" alt="PCA9685 PWM LED/Servo Controller Driver in Rust" class="thumbnail-image"></span></a></div><div class="item-inner"><p class="item-category"><a class="article-category-link" href="/categories/embedded/">embedded</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/embedded/rust/">rust</a></p><p class="item-title"><a href="/pca9685-pwm-led-servo-controller-driver-in-rust/" class="title">PCA9685 PWM LED/Servo Controller Driver in Rust</a></p><p class="item-date"><time datetime="2019-12-10T14:10:15.000Z" itemprop="datePublished">2019-12-10</time></p></div></li><li><div class="item-thumbnail"><a href="/si4703-fm-radio-receiver-driver-in-rust/" class="thumbnail"><span style="background-image:url(/images/si4703-module.jpg)" alt="Si4703 FM Radio Receiver Driver in Rust" class="thumbnail-image"></span></a></div><div class="item-inner"><p class="item-category"><a class="article-category-link" href="/categories/embedded/">embedded</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/embedded/rust/">rust</a></p><p class="item-title"><a href="/si4703-fm-radio-receiver-driver-in-rust/" class="title">Si4703 FM Radio Receiver Driver in Rust</a></p><p class="item-date"><time datetime="2019-12-03T18:22:18.000Z" itemprop="datePublished">2019-12-03</time></p></div></li><li><div class="item-thumbnail"><a href="/opt300x-ambient-light-sensor-driver-in-rust/" class="thumbnail"><span style="background-image:url(/images/opt3001.jpg)" alt="OPT300x Ambient Light Sensor Driver in Rust" class="thumbnail-image"></span></a></div><div class="item-inner"><p class="item-category"><a class="article-category-link" href="/categories/embedded/">embedded</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/embedded/rust/">rust</a></p><p class="item-title"><a href="/opt300x-ambient-light-sensor-driver-in-rust/" class="title">OPT300x Ambient Light Sensor Driver in Rust</a></p><p class="item-date"><time datetime="2019-11-09T16:22:18.000Z" itemprop="datePublished">2019-11-09</time></p></div></li><li><div class="item-thumbnail"><a href="/veml6075-uva-uvb-uv-index-light-sensor-driver-in-rust/" class="thumbnail"><span style="background-image:url(/images/veml6075.jpg)" alt="VEML6075 UVA and UVB Light Sensor Driver in Rust" class="thumbnail-image"></span></a></div><div class="item-inner"><p class="item-category"><a class="article-category-link" href="/categories/embedded/">embedded</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/embedded/rust/">rust</a></p><p class="item-title"><a href="/veml6075-uva-uvb-uv-index-light-sensor-driver-in-rust/" class="title">VEML6075 UVA and UVB Light Sensor Driver in Rust</a></p><p class="item-date"><time datetime="2019-09-28T09:22:18.000Z" itemprop="datePublished">2019-09-28</time></p></div></li><li><div class="item-thumbnail"><a href="/mcp794xx-real-time-clock-rtc-driver-in-rust/" class="thumbnail"><span style="background-image:url(/images/mcp7940n.jpg)" alt="MCP794xx Real-Time Clock (RTC) / Calendar Driver in Rust" class="thumbnail-image"></span></a></div><div class="item-inner"><p class="item-category"><a class="article-category-link" href="/categories/embedded/">embedded</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/embedded/rust/">rust</a></p><p class="item-title"><a href="/mcp794xx-real-time-clock-rtc-driver-in-rust/" class="title">MCP794xx Real-Time Clock (RTC) / Calendar Driver in Rust</a></p><p class="item-date"><time datetime="2019-09-15T10:22:17.000Z" itemprop="datePublished">2019-09-15</time></p></div></li></ul></div></div><div class="widget-wrap widget-list"><h3 class="widget-title">categories</h3><div class="widget"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/embedded/">embedded</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/embedded/rust/">rust</a><span class="category-list-count">12</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/">programming</a><span class="category-list-count">1</span></li></ul></div></div><div class="widget-wrap widget-list"><h3 class="widget-title">archives</h3><div class="widget"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/02/">February 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/01/">January 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/04/">April 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/10/">October 2009</a><span class="archive-list-count">1</span></li></ul></div></div><div class="widget-wrap widget-list"><h3 class="widget-title">tags</h3><div class="widget"><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/">c++</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/driver/">driver</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/embedded/">embedded</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/game/">game</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ipc/">ipc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rust/">rust</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stl/">stl</a><span class="tag-list-count">1</span></li></ul></div></div><div class="widget-wrap widget-float"><h3 class="widget-title">tag cloud</h3><div class="widget tagcloud"><a href="/tags/c/" style="font-size:15px">c++</a> <a href="/tags/driver/" style="font-size:17.5px">driver</a> <a href="/tags/embedded/" style="font-size:20px">embedded</a> <a href="/tags/game/" style="font-size:12.5px">game</a> <a href="/tags/ipc/" style="font-size:10px">ipc</a> <a href="/tags/rust/" style="font-size:17.5px">rust</a> <a href="/tags/stl/" style="font-size:10px">stl</a></div></div><div class="widget-wrap widget-list"><h3 class="widget-title">links</h3><div class="widget"><ul><li><a href="https://github.com/eldruin">My GitHub profile</a></li></ul></div></div></div></aside></div></div></div><footer id="footer"><div class="container"><div class="container-inner"><a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a><div class="credit"><h1 class="logo-wrap"><a href="/" class="logo"></a></h1><p>&copy; 2019 Diego Barrios Romero</p><p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>. Theme by <a href="//github.com/ppoffice" target="_blank">PPOffice</a></p></div><div class="footer-plugins"></div></div></div></footer><script>var disqus_shortname="eldruinsblog",disqus_url="https://blog.eldruin.com/inter-process-communication-pipe-fork-cpp-stl-like-streams/";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><script src="/libs/lightgallery/js/lightgallery.min.js"></script><script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script><script src="/libs/lightgallery/js/lg-pager.min.js"></script><script src="/libs/lightgallery/js/lg-autoplay.min.js"></script><script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script><script src="/libs/lightgallery/js/lg-zoom.min.js"></script><script src="/libs/lightgallery/js/lg-hash.min.js"></script><script src="/libs/lightgallery/js/lg-share.min.js"></script><script src="/libs/lightgallery/js/lg-video.min.js"></script><script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="/js/main.js"></script></div></body>